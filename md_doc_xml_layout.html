<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>duilib自学教程: 了解 XML 使用 （布局）</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">duilib自学教程
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">了解 XML 使用 （布局） </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>本节主要介绍 <a class="el" href="namespace_dui_lib.html">DuiLib</a> 中 XML 关键字的使用和一些特性，通过构建一个简单的带标题栏和简单结构的窗口，目的为了了解 XML 的布局系统、基本控件和一些全局属性。在介绍之前我们先改造一下程序，让程序在 Debug 模式下使用本地的 XML 文件，只有在发布为 Release 版本时才使用打包到程序中的 ZIP 资源文件。修改 GetSkinFolder 和 GetResourceType 两个方法，如下所示。</p>
<div class="fragment"><div class="line">DuiLib::CDuiString MainWndFrame::GetSkinFolder()</div><div class="line">{</div><div class="line">#if _DEBUG</div><div class="line">    return _T(&quot;theme&quot;);</div><div class="line">#else</div><div class="line">    return m_PaintManager.GetInstancePath();</div><div class="line">#endif</div><div class="line">}</div><div class="line">.....</div><div class="line">.....</div><div class="line">DuiLib::UILIB_RESOURCETYPE MainWndFrame::GetResourceType() const</div><div class="line">{</div><div class="line">#if _DEBUG</div><div class="line">    return UILIB_FILE;</div><div class="line">#else</div><div class="line">    return UILIB_ZIPRESOURCE;</div><div class="line">#endif</div><div class="line">}</div></div><!-- fragment --><p>这样我们程序在 Debug 模式下使用的就是本地的 theme 文件夹内的资源了，主要是方便我们进行更新即时查看。接下来我们先从主要的几个布局开始，DuiLib 中重要的几个布局分别如下</p>
<ul>
<li>HorizontalLayout 和 VerticalLayout</li>
<li>TabLayout</li>
<li>TileLayout</li>
<li>Container</li>
<li>ChildLayout</li>
</ul>
<p>使用频率由上到下，下面我们分别介绍几种布局的特点。</p>
<h2>HorizontalLayout 和 VerticalLayout</h2>
<p><a class="el" href="namespace_dui_lib.html">DuiLib</a> 的布局系统类似于 Qt 的布局系统， HorizontalLayout（水平布局） 和 VerticalLayout（垂直布局）来给界面划分整体区域。HorizontalLayout 顾名思义，就是让其包含的控件以水平位置排布。而 VerticalLayout 则是让起包含的控件以垂直方向进行排布。两种布局在界面中最终体现为什么样子？我们可以做一个实现来验证一下效果。但无论我们使用什么布局，最少要有一个最外部的布局。如下所示：</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;Window size=&quot;640,480&quot; caption=&quot;0,0,0,35&quot;&gt;</div><div class="line">    &lt;VerticalLayout&gt;</div><div class="line">        &lt;!-- 窗口内容 --&gt;</div><div class="line">    &lt;/VerticalLayout&gt;</div><div class="line">&lt;/Window&gt;</div></div><!-- fragment --><p>第一行是 xml 描述，这个必须要有的，不了解的同学可以搜索一些 XML 相关的介绍教程，十几分钟就看的差不多了。Window 标签也是必须要有的外部标签，size 属性决定了这个窗口的大小，caption 属性决定了这个窗口的标题栏有效范围是多大的，我们设置了 35 像素，也就是整个窗口最上方的 35 像素是可以用鼠标点击拖动的，更多的属性我们后面再来看 <code>属性列表.xml</code>，这里先不多介绍。</p>
<p><a class="el" href="namespace_dui_lib.html">DuiLib</a> 通过这个 Window 标签来识别窗口。Window 里面的 VerticalLayout 是一个最外部的布局，我们要写窗体的内部构成，都是基于这个最基本的窗体布局系统来完成的。当然你并不一定必须用 VerticalLayout 来做最外部的布局，这要看你窗口的实际布局效果。如果窗体是从左到右的水平布局模式，那你应该用 HorizontalLayout。</p>
<p>首先我们在这个基本的布局系统中添加三个子布局 HorizontalLayout 并设置成三种不同的颜色（通过 bkcolor 属性）来看一下效果是什么样子的。</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;Window size=&quot;640,480&quot; caption=&quot;0,0,0,35&quot;&gt;</div><div class="line">    &lt;VerticalLayout&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FFD81E06&quot;/&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1AFA29&quot;/&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1296DB&quot;/&gt;</div><div class="line">    &lt;/VerticalLayout&gt;</div><div class="line">&lt;/Window&gt;</div></div><!-- fragment --><p>以上效果在程序运行后显示如下效果。</p>
<img src="../images/2018-04-29_17-23-43.png" alt="" class="inline"/>
<p>可以看出，三个 HorizontalLayout 被父控件规定为以垂直方式布局，从上到下依次排列，垂直布局不关心控件宽度，如果我们把外部的 VerticalLayout 修改为 HorizontalLayout。那么下面的三个控件应该是水平的从做到右以此排列。如下所示</p>
<img src="../images/2018-04-29_17-24-06.png" alt="" class="inline"/>
<p>如果我们在子布局中再添加一些其他的控件，我们就能看出，HorizontalLayout 下面的控件也是遵循它父级的规定来水平布局的。如下所示</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;Window size=&quot;640,480&quot; caption=&quot;0,0,0,35&quot;&gt;</div><div class="line">    &lt;HorizontalLayout&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FFD81E06&quot;&gt;</div><div class="line">            &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">            &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">            &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">        &lt;/HorizontalLayout&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1AFA29&quot;/&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1296DB&quot;/&gt;</div><div class="line">    &lt;/HorizontalLayout&gt;</div><div class="line">&lt;/Window&gt;</div></div><!-- fragment --><p>控件的排布效果如下</p>
<img src="../images/2018-04-29_17-24-54.png" alt="" class="inline"/>
<p>这就是基本的水平和垂直布局系统的简单介绍，这两种布局是使用频率最高的了，基本上界面的布局需求都可以通过这两种布局来实现了。但是总会有个别的布局场景是需要个性化一点的，就像下面的 TabLayout。</p>
<h2>TabLayout</h2>
<p>TabLayout 实现了一个 Tab 标签页方式的布局系统，其下包含的内容只能显示一个。如下所示，默认显示第一个红色的布局。</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;Window size=&quot;640,480&quot; caption=&quot;0,0,0,35&quot;&gt;</div><div class="line">    &lt;TabLayout&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FFD81E06&quot;&gt;</div><div class="line">            &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">            &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">            &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">        &lt;/HorizontalLayout&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1AFA29&quot;/&gt;</div><div class="line">        &lt;HorizontalLayout bkcolor=&quot;#FF1296DB&quot;/&gt;</div><div class="line">    &lt;/TabLayout&gt;</div><div class="line">&lt;/Window&gt;</div></div><!-- fragment --><img src="../images/2018-04-29_17-25-17.png" alt="" class="inline"/>
<p>而想显示另外的两个布局，我们需要通过代码来控制。这里大家只需要有一个概念，后面我们模仿其他 Demo 的时候会用到这个布局。</p>
<h2>TileLayout</h2>
<p>TileLayout 是一个块级的布局，它下面的控件都会以块为单位，像麻将一样一排一排的组合，测试代码：</p>
<div class="fragment"><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;Window size=&quot;640,480&quot; caption=&quot;0,0,0,35&quot;&gt;</div><div class="line">    &lt;TileLayout&gt;</div><div class="line">        &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;1&quot; height=&quot;30&quot; bkcolor=&quot;#FFD81E06&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;2&quot; height=&quot;30&quot; bkcolor=&quot;#FF1AFA29&quot; /&gt;</div><div class="line">        &lt;Button text=&quot;3&quot; height=&quot;30&quot; bkcolor=&quot;#FF1296DB&quot; /&gt;</div><div class="line">    &lt;/TileLayout&gt;</div><div class="line">&lt;/Window&gt;</div></div><!-- fragment --><p>效果如下</p>
<img src="../images/2018-04-29_17-26-21.png" alt="" class="inline"/>
<p>TileLayout 有两个比较关键的属性，<code>itemsize</code> 和 <code>columns</code>，两者不能同时使用。前者决定 TileLayout 包含的子控件以多大尺寸来排列，后者决定了 TileLayout 有几列数据，我们先将 itemsize 指定为 "50,50"，就是告诉 TileLayout 让子控件以宽度和高度分别 50 的大小来进行排列。效果如下</p>
<img src="../images/2018-04-29_17-26-42.png" alt="" class="inline"/>
<p>如果我们指定了 <code>columns</code> 为 3，那么行只有 3 列数据。</p>
<img src="../images/2018-04-29_17-27-02.png" alt="" class="inline"/>
<h2>Container</h2>
<p>Container 本来是所有 Layout 的基类，之所以没提前介绍它主要是它使用的场景比较少，它下面的子空间都是默认扩充整个容器的，这也就会导致所有子控件重叠在一起，除非你想实现这种效果，否则可能真的用不到它。</p>
<h2>ChildLayout</h2>
<p>ChildLayout 我基本没有用过，看过官方的一些例子和 Redrain 介绍，它的功能类似于 include 一个 XML。主要功能就是有些 XML 文件因为规划不合理代码写的又臭又长，使用这个布局可以将外部的 XML 引入到本 XML 文件中，指定它的 xmlfile 属性就可以了。 </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
